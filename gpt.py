import openai
from cfg import OPENAI_API_KEY

client = openai.OpenAI(api_key=OPENAI_API_KEY)

def beautify_text(text):
    system_prompt = (
        "Ты — профессиональный редактор.\n"
        "Твоя единственная задача: исправить орфографические, пунктуационные и грамматические ошибки в тексте.\n"
        "Запрещено что-либо комментировать, отвечать на вопросы, обсуждать, рассуждать или добавлять свои мысли.\n"
        "Запрещено вставлять приветствия, пояснения или любые ответы — только исправленный текст.\n"
        "Не меняй смысл, стиль и структуру исходного текста.\n"
        "Мат и ненормативная лексика должны остаться.\n"
        "Каждое новое предложение начинай с новой строки (если использовал точку, то новое предложение уже с новой строчки начинай обязательно).\n"
        "Верни только исправленный текст, никаких дополнительных фраз."
    )
    user_prompt = (
        f"Исправь только ошибки в этом тексте, не добавляй ничего от себя, не пиши комментарии. Текст: {text}"
    )
    response = client.chat.completions.create(
        model="gpt-4o-mini",
        messages=[
            {"role": "system", "content": system_prompt},
            {"role": "user", "content": user_prompt}
        ],
        temperature=0.2,      # Минимум креативности, максимум точности
        max_tokens=1024,
    )
    return response.choices[0].message.content.strip()
